<form id="form">
  <input type="text" name="text1" />
  <input type="file" name="file" multiple />
  <button type="submit">提交</button>
  <button id="download">下载</button>
</form>
<script src="/static/js/jquery.js"></script>
<script>
  $(function ($) {
    $("#form").on("submit", function (e) {
      e.preventDefault();
      const formData = new FormData(this);
      $.ajax({
        type: "POST",
        url: "/submit", // 你的服务器端点URL
        data: formData,
        contentType: false,
        processData: false,
        success: function (response) {
          console.log("Form submitted successfully");
          // 处理响应
        },
        error: function () {
          console.log("Error submitting form");
        },
      });
    });

    $("#download").on("click", function () {
      $.ajax({
        url: "/download",
        method: "GET",
        data: { id: 123 },
        xhrFields: { responseType: "blob" }, // 必须
        success: function (blob, status, xhr) {
          const filename =
            (xhr
              .getResponseHeader("Content-Disposition")
              .match(/filename="(.+)"/) || [])[1] || "file.xlsx";
          const url = URL.createObjectURL(blob);
          const a = $("<a>").attr({ href: url, download: filename })[0];
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          setTimeout(() => URL.revokeObjectURL(url), 30000);
        },
        error: function (xhr) {
          alert("下载失败");
        },
      });
    });
  });
</script>